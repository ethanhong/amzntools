const isAftliteNa="aftlite-na.amazon.com"===window.location.hostname,cellIndex={};function userTrackingInspector(){const t=isAftliteNa?document.querySelector(".reportLayout"):document.querySelector("#main-content > table");if(null==t)return;preparePage(t);const e=getRows(t),n=new Set;e.forEach(((t,e,l)=>{const o=t.cells[cellIndex.action].textContent.trim(),c=t.cells[cellIndex.picklistId].textContent.trim();"pack"===o&&!n.has(c)&&isValidID(c)&&(n.add(c),fetchPicklistHistoryPage(c).then((t=>extractToteInfo(t))).then((t=>changePageContent(c,t,l))))})),addCSS()}function preparePage(t){isAftliteNa||t.classList.remove("a-vertical-stripes");const e=t.rows[0].cells[cellIndex.completionTime],n=t.rows[0].cells[cellIndex.cpt],l=t.rows[0].cells[cellIndex.status];e.textContent="Completion Time",n.textContent="CPT",l.textContent="Status"}function getRows(t){return[...t.rows].slice(1)}async function fetchPicklistHistoryPage(t){return fetch(`${isAftliteNa?"/wms/view_picklist_history?picklist_id=":"/picklist/view_picklist_history?picklist_id="}${encodeURIComponent(t)}`).then((t=>t.text()))}function extractToteInfo(t){const e={cpt:"",completionTime:"",status:""},n=isAftliteNa?"body > table:nth-child(6) > tbody > tr:nth-child(2)":"div.a-row:nth-child(6)",l=isAftliteNa?"body > table:nth-child(6) > tbody > tr:nth-child(6)":"div.a-row:nth-child(10)",o=isAftliteNa?"body > table:nth-child(6) > tbody > tr:nth-child(8)":"div.a-row:nth-child(12)",c=/\d{1,2}:\d{1,2}/,i=(new DOMParser).parseFromString(t,"text/html");let s=i.querySelector(o).textContent.match(c);return s&&([e.cpt]=s),s=i.querySelector(l).textContent.match(c),s&&([e.completionTime]=s),s=i.querySelector(n).textContent.match(/\((\w+)\)/),s&&([,e.status]=s),e}[cellIndex.action,cellIndex.completionTime,cellIndex.cpt,cellIndex.toteSpoo,cellIndex.status,cellIndex.picklistId]=isAftliteNa?[1,8,9,10,11,13]:[1,7,8,9,10,12];const now=new Date,pullTimeStyle=new Map([[(now.getHours()+1)%24+":15","late-window"],[(now.getHours()+2)%24+":15","current-window"],[(now.getHours()+3)%24+":15","next-window"]]);function changePageContent(t,e,n){n.forEach((n=>{if(n.cells[cellIndex.picklistId].textContent.trim()===t){const t=n.cells[cellIndex.completionTime],l=n.cells[cellIndex.cpt],o=n.cells[cellIndex.toteSpoo],c=n.cells[cellIndex.status];t.textContent=e.completionTime,c.textContent=e.status,l.textContent=e.cpt;let i="less-important";pullTimeStyle.has(e.cpt)&&(i=pullTimeStyle.get(e.cpt)),l.classList.add(i),o.classList.add(i)}}))}function isValidID(t){return/^\d{7}$/.test(t)}function addCSS(){const t=document.createElement("style");t.innerText="\n    .late-window {\n      background-color: Pink;\n    }\n    .current-window {\n      background-color: MediumAquaMarine;\n    }\n    .next-window {\n      background-color: SkyBlue;\n    }\n    .less-important {\n      background-color: LightGray;\n    }\n  ",document.head.appendChild(t)}